<app-navbar></app-navbar>

<div class="container">
  <div class="form-section">
    <h2 class="mb-4">Editar Datos del Cliente</h2>

    <div *ngIf="successMessage" class="alert alert-success" role="alert">
      <span>{{ successMessage }}</span>
    </div>
    <div *ngIf="errorMessage" class="alert alert-danger" role="alert">
      <span>{{ errorMessage }}</span>
    </div>

    <form (ngSubmit)="onSubmit()" #clienteForm="ngForm">
      <input type="hidden" [(ngModel)]="cliente.id" name="id">
      
      <div class="row mb-3">
        <div class="col-md-6">
          <label for="nombres" class="form-label">Nombres:</label>
          <input type="text" id="nombres" name="nombres" [(ngModel)]="cliente.nombres" class="form-control" required>
        </div>
        <div class="col-md-6">
          <label for="apellidos" class="form-label">Apellidos:</label>
          <input type="text" id="apellidos" name="apellidos" [(ngModel)]="cliente.apellidos" class="form-control" required>
        </div>
      </div>
      
      <div class="row mb-3">
        <div class="col-md-6">
          <label for="dni" class="form-label">DNI:</label>
          <input type="text" id="dni" name="dni" [(ngModel)]="cliente.dni" (input)="onDniInput($event)" 
                 class="form-control" required pattern="[0-9]{8}" maxlength="8" 
                 title="El DNI debe tener exactamente 8 dígitos numéricos">
        </div>
        <div class="col-md-6">
          <label for="nacionalidad" class="form-label">Nacionalidad:</label>
          <input type="text" id="nacionalidad" name="nacionalidad" [(ngModel)]="cliente.nacionalidad" class="form-control" required>
        </div>
      </div>
      
      <div class="row mb-3">
        <div class="col-md-6">
          <label for="email" class="form-label">Email:</label>
          <input type="email" id="email" name="email" [(ngModel)]="cliente.email" class="form-control" required>
        </div>
        <div class="col-md-6">
          <label for="telefono" class="form-label">Teléfono:</label>
          <input type="tel" id="telefono" name="telefono" [(ngModel)]="cliente.telefono" class="form-control" required>
        </div>
      </div>

      <div class="d-grid gap-2 d-md-flex justify-content-md-end">
        <a [routerLink]="isCliente ? '/dashboard' : '/clientes/historial'" class="btn btn-secondary me-md-2">
          <i class="fas fa-arrow-left"></i> {{ isCliente ? 'Volver a Mi Cuenta' : 'Volver al Historial' }}
        </a>
        <button type="submit" class="btn btn-primary" [disabled]="isSubmitting">
          <i class="fas fa-save"></i> <span *ngIf="!isSubmitting">Guardar Cambios</span>
          <span *ngIf="isSubmitting">Guardando...</span>
        </button>
      </div>
    </form>
  </div>
</div>
